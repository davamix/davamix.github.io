<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content=".NET Developer - Blog">
    <meta name="author" content="Daniel Valcarce">
    <meta name="og:tile" content=".NET Developer - Blog">
    <meta name="og:description" content=".NET Developer and Machine Learning apprentice">
    <meta name="og:image" content="https://raw.githubusercontent.com/davamix/davamix.github.io/master/images/binary.png">
    <meta name="og:url" content="https://davamix.net/">
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:domain" content="davamix.net"/>
    <meta name="twitter:title" content="Daniel Valcarce web">
    <meta name="twitter:description" content=".NET Developer and Machine Learning apprentice">
    <meta name="twitter:image" content="https://raw.githubusercontent.com/davamix/davamix.github.io/master/images/binary.png">

    <!-- Load JQuery at the beginning in order to run functions in comments.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://davamix.net/scripts/comments.js"></script>

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
        crossorigin="anonymous">
    <link rel="stylesheet" href="https://davamix.net/styles/main.css">
</head>

<body>

    <nav class="navbar navbar-expand-lg fixed-top" style="background-color: dodgerblue">
        <a class="navbar-brand" href="#">Daniel Valcarce - .NET Developer</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarLinks" aria-controls="navbarLinks"
            aria-expanded="false" aria-label="Toggle navigation">
            <i class="far fa-bars fa-2x" style="color:white"></i>
        </button>

        <!-- Section links -->
        <div class="collapse navbar-collapse" id="navbarLinks">
            <ul class="navbar-nav mr-2">
                <li class="nav-item">
                    <a class="nav-link" href="https://davamix.net" title="Home - Blog">
                        <div class="d-inline-block d-lg-none">
                            <i class="fas fa-home fa-2x"></i>
                            <span>Home - Blog</span>
                        </div>
                        <i class="fas fa-home fa-3x d-lg-inline-block d-none"></i>
                    </a>
                </li>
            </ul>
            <ul class="navbar-nav mr-2">
                <li class="nav-item">
                    <a class="nav-link" href="https://davamix.net/sections/code.html" title="Code examples and Katas">
                        <div class="d-inline-block d-lg-none">
                            <i class="fal fa-code fa-2x"></i>
                            <span>Code</span>
                        </div>
                        <i class="fal fa-code fa-3x d-lg-inline-block d-none"></i>
                    </a>
                </li>
            </ul>
            <!-- <ul class="navbar-nav mr-2">
                <li class="nav-item">
                    <a class="nav-link" href="https://davamix.net/sections/projects.html" title="Personal projects">
                        <div class="d-inline-block d-lg-none">
                            <i class="fal fa-lightbulb fa-2x"></i>
                            <span>Personal projects</span>
                        </div>
                        <i class="fal fa-lightbulb fa-3x d-lg-inline-block d-none"></i>
                    </a>
                </li>
            </ul> -->
        </div>

        <!-- Social links -->
        <div class="collapse navbar-collapse" id="navbarLinks">
            <ul class="navbar-nav mr-4">
                <li class="nav-item">
                    <a class="nav-link" target="_blank" href="https://github.com/davamix" title="Code on Github">
                        <div class="d-inline-block d-lg-none">
                            <i class="fab fa-github-square fa-2x"></i>
                            <span>Github</span>

                        </div>
                        <i class="fab fa-github-square fa-3x d-lg-inline-block d-none"></i>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" target="_blank" href="https://twitter.com/davamix" title="@davamix on Twitter">
                        <div class="d-inline-block d-lg-none">
                            <i class="fab fa-twitter-square fa-2x"></i>
                            <span>Twitter</span>

                        </div>
                        <i class="fab fa-twitter-square fa-3x  d-lg-inline-block d-none"></i>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" target="_blank" href="https://www.linkedin.com/in/danielvalcarce/" title="Linkedin profile">
                        <div class="d-inline-block d-lg-none">
                            <i class="fab fa-linkedin fa-2x"></i>
                            <span>Linkedin</span>

                        </div>
                        <i class="fab fa-linkedin fa-3x  d-lg-inline-block d-none"></i>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" target="_blank" href="https://davamix.wordpress.com/" title="Old blog on Wordpress">
                        <div class="d-inline-block d-lg-none">
                            <i class="fab fa-wordpress fa-2x"></i>
                            <span>Old blog</span>

                        </div>
                        <i class="fab fa-wordpress fa-3x  d-lg-inline-block d-none"></i>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" target="_blank" href="mailto:davamix@gmail.com?subject=[DavamixNet]" title="Contact me at davamix@gmail.com">
                        <div class="d-inline-block d-lg-none">
                            <i class="far fa-at fa-2x"></i>
                            <span>Contact me at davamix@gmail.com</span>

                        </div>
                        <i class="far fa-at fa-3x  d-lg-inline-block d-none"></i>
                    </a>
                </li>
            </ul>
        </div>
    </nav>

    <main>
        <div class="blog">
            <div class="container">
                <!-- POST: Save video frames as images with OpenCV -->
                <div class="post">
                    <div class="title">
                        <a href="https://davamix.net/posts/save-video-frames-as-images-with-opencv.html">
                            <h1>Save video frames as images with OpenCV</h1>
                        </a>
                        <span class="d-flex p-2 date">15-03-2019</span>
                        <hr />
                    </div>

                    <p>
                        To read a frame we'll use the method <a href="https://docs.opencv.org/4.0.1/d8/dfe/classcv_1_1VideoCapture.html#a473055e77dd7faa4d26d686226b292c1">read()</a> 
                            from the <a href="https://docs.opencv.org/4.0.1/d8/dfe/classcv_1_1VideoCapture.html">VideoCapture</a> class then this frame can be saved with the 
                            <a href="https://docs.opencv.org/4.0.1/d4/da8/group__imgcodecs.html#gabbc7ef1aa2edfaa87772f1202d67e0ce">imwrite</a> method.
                    </p>

                    <div class="code">
                        <code>
                            import cv2<br/><br/>

                            video = cv2.VideoCapture("./video_file.mp4")<br/><br/>
                            
                            success, image = video.read()<br/><br/>
                            
                            if success:<br/>
                            &emsp;&emsp;&emsp;&emsp;cv2.imwrite("frame.jpg", image)
                        </code>
                    </div>
                    
                    <p>
                        The method <em>read()</em> returns two values, <em>success</em> is a boolean that tell us if a frame has been grabbed and the 
                        <em>image</em> value is the frame itself.
                        
                        Then using the method <em>imwrite</em> we'll save that frame as an image file.
                    </p>
                    <p>
                            To save more than one frame or even all frames as images we need to put the read() into a loop, for instance:
                    </p>

                    <div class="code">
                        <code>
                            import cv2<br/><br/>

                            video = cv2.VideoCapture("./video_file.mp4")<br/><br/>

                            # Read the first frame<br/>
                            success, image = video.read()<br/>
                            frame_id = 0<br/><br/>

                            while success:<br/>
                            &emsp;&emsp;&emsp;&emsp;cv2.imwrite("frame{}.jpg".format(frame_id), image)<br/>
                            &emsp;&emsp;&emsp;&emsp;success, image = video.read()<br/>
                            &emsp;&emsp;&emsp;&emsp;frame_id += 1<br/>
                        </code>
                    </div>

                    <p>I created a script to save a percentage of the video frames as images. Check it out the <a href="https://github.com/davamix/frames-extractor">frames-extractor script</a>.</p>

                </div> <!-- post -->
                <div class="footer mt-4">
                    <a class="comments" href="https://davamix.net/posts/save-video-frames-as-images-with-opencv.html#post-comments">
                        <div id="blog-post-date4"></div>
                    </a>
                    <hr />
                    <script type="text/javascript">
                        GetTotalComments(4);
                    </script>
                </div>
                
                
                <!-- POST: Configure a self-signed certificate in Ubuntu to allow HTTPS access with an ASP.NET Core 2.1 application -->
                <div class="post">

                    <div class="title">
                        <a href="https://davamix.net/posts/asp-net-core-2-with-https.html">
                            <h1>Configure a self-signed certificate in Ubuntu to allow HTTPS access with an ASP.NET Core 2.1 application</h1>
                        </a>
                        <span class="d-flex p-2 date">17-07-2018</span>
                        <hr />
                    </div>

                    <p>1. Create an asp.net core project as usual and check if you have access using HTTPS.</p>
                    <div class="code">
                        <code class="prompt">dotnet new web -o Sample</code>
                        <code class="prompt">cd Sample</code>
                        <code class="prompt">dotnet restore</code>
                        <code class="prompt">dotnet run</code>
                    </div>
                    <p>
                        1.1 Navigate to
                        <a href="https://localhost:5001">https://localhost:5001</a>. Can you read the message
                        <mark>Hello World!</mark>? Congrats, you can stop reading this guide. If Firefox shows you a
                        <mark>Secure Connection Failed</mark> message or you have an error message in console like this:
                    </p>
                    <div class="code">
                        <code>
                            dbug: HttpsConnectionAdapter[1]<br/>
                            Failed to authenticate HTTPS connection.<br/>
                            System.Security.Authentication.AuthenticationException: Authentication failed, see inner exception. ---> Interop+Crypto+OpenSslCryptographicException: error:2006D002:BIO routines:BIO_new_file:system lib<br/>
                        </code>
                    </div>
                    Keep reading.

                    <p>2. Install<mark>ca-certificates</mark> and <mark>openssl</mark> packages</p>
                    <div class="code">
                        <code class="prompt">
                            sudo apt-get install ca-certificates openssl
                        </code>
                    </div>
                    
                    <p>3. Genereate the .pfx certificate with dotnet command [<a href="#link1">1</a>]</p>
                    <div class="code">
                        <code class="prompt">
                            dotnet dev-certs https -ep ${HOME}/.aspnet/https/aspnetapp.pfx -p crypticpassword
                        </code>
                    </div>
                    
                    <p>4. Extract the .crt file [<a href="#link2">2</a>]</p>
                    <div class="code">
                        <code class="prompt">cd ${HOME}/.aspnet/https/</code>
                        <code class="prompt">openssl pkcs12 -in aspnetapp.pfx -nocerts -out aspnetapp.pfx</code>
                        <code class="prompt">openssl pkcs12 -in aspnetapp.pfx -clcerts -nokeys -out aspnetapp.crt</code>
                    </div>
                    
                    <p>5. Copy the .crt file to the certificates location [<a href="#link3">3</a>]</p>
                    <div class="code">
                        <code class="prompt">
                            sudo cp aspnetapp.crt /usr/local/share/ca-certificates/
                        </code>
                    </div>
                    
                    <p>6. Change the permissions to allow to read the certificate [<a href="#link4">4</a>]</p>
                    <div class="code">
                        <code class="prompt">
                            sudo chmod +r /usr/local/share/ca-certificates/*
                        </code>
                    </div>
                    
                    <p>7. Run the application again and check the https address</p>
                    <div class="code">
                        <code class="prompt">
                            dotnet run
                        </code>
                    </div>
                    <p>
                        Navigate to <a href="https://localhost:5001">https://localhost:5001</a>. If you have any error, you can check the links below to know more about each step.
                    </p>
                    <div class="post-links-section">
                        <h2>LINKS</h2>
                        <span id="link1">[1] <a href="https://github.com/dotnet/dotnet-docker/blob/master/samples/aspnetapp/aspnetcore-docker-https.md">https://github.com/dotnet/dotnet-docker/blob/master/samples/aspnetapp/aspnetcore-docker-https.md</a></span><br />
                        <span id="link2">[2] <a href="https://www.markbrilman.nl/2011/08/howto-convert-a-pfx-to-a-seperate-key-crt-file/">https://www.markbrilman.nl/2011/08/howto-convert-a-pfx-to-a-seperate-key-crt-file/</a></span><br />
                        <span id="link3">[3] <a href="https://stackoverflow.com/a/44160125">https://stackoverflow.com/a/44160125</a></span><br />
                        <span id="link4">[4] <a href="https://github.com/dotnet/cli/issues/9376#issuecomment-393954876">https://github.com/dotnet/cli/issues/9376#issuecomment-393954876</a></span><br />
                    </div>
                </div> <!-- post -->

                <div class="footer mt-4">
                    <a class="comments" href="https://davamix.net/posts/asp-net-core-2-with-https.html#post-comments">
                        <div id="blog-post-date1"></div>
                    </a>
                    <hr />
                    <script type="text/javascript">
                        GetTotalComments(1);
                    </script>
                </div>

                <!-- POST: Install .NET Framework 3.5 on Windows 10-->
                <div class="post">
                        <div class="title">
                            <a href="https://davamix.net/posts/install-net-3-5-on-Windows-10.html">
                                <h1>Install .NET Framework 3.5 on Windows 10</h1>
                            </a>    
                            <span class="d-flex p-2 date">25-04-2017</span>
                            <hr />
                        </div>
    
                        <p>
                            On Windows 10 is not possible to install .NET Framework 3.5 using the <mark>Turn Windows features on or off</mark> option because the error <mark>0x800F081F</mark>.
                            In my case I installed it following the steps below:
                        </p>
                        <p>1. Go to <a href="https://my.visualstudio.com">https://my.visualstudio.com</a> and download <mark>Windows 10 Features on Demand</mark> iso (x86 or x64).</p>
                        <p>2. Mount the iso</p>
                        <p>3. Open a PowerShell command line as Administrator and run the next command</p>
                        <div class="code">
                            <code>Dism /online /enable-feature /featurename:NetFX3 /All /Source:D:\ /LimitAccess</code>
                        </div>
                        
                        <p>The output should something like this:</p>
                        <div class="code">
                            <code>
                                Deployment Image Servicing and Management tool<br />
                                Version: 10.0.14393.0<br />
                                <br />
                                Image Version: 10.0.14393.0<br />
                                <br />
                                Enabling feature(s)<br />
                                [==========================100.0%==========================]<br />
                                The operation completed successfully.
                            </code>
                        </div>
    
                        <p>If you go to "Turn Windows features on or off" the option fot .NET Framework 3.5 must be cheked.</p>
                    </div> <!-- post -->
                    <div class="footer mt-4">
                        <a class="comments" href="https://davamix.net/posts/install-net-3-5-on-Windows-10.html#post-comments">
                            <div id="blog-post-date2"></div>
                        </a>
                        <hr />
                        <script type="text/javascript">
                            GetTotalComments(2);
                        </script>
                    </div>

                    <!-- POST: Create and configure a local NuGet server -->
                    <div class="post">
                        <div class="title">
                            <a href="https://davamix.github.io/posts/create-local-nuget-server.html">
                                <h1>Create and configure a local NuGet server</h1>
                            </a>
                            <span class="d-flex p-2 date">17-07-2018</span>
                            <hr />
                        </div>
    
                        <p>
                            This guide will work with three project, the Nuget Server project, the Nuget Package project that contains a simple library and a Sample project to use the package created.
                        </p>
    
                        <h3>Nuget Server project</h3>
                        <p>
                            <strong>1.</strong> Install the IIS server if you don't have it yet.<br/>
                            <strong>2.</strong> Create a new site, NugetServer for example, to host the server.<br/>
                            <strong>3.</strong> Configure the port 8080 if its free, or any other as you wish.<br/>
                        </p>
                        <p>
                            From Visual Studio:<br/>
                            <strong>1.</strong> Create an ASP.NET web project with the <mark>Empty</mark> template. <br/>
                            <strong>2.</strong> Install the <mark>Nuget.Server</mark> package.<br/>
                            <span class="anchor" id="nuget-server-note1"></span>
                            <div class="note">
                                <strong>Note</strong><br/>
                                Check the <em>web.config</em> and be sure that the <mark>targetFramework</mark> version from <mark>httpRuntime</mark> entry is the same that <mark>targetFramework</mark> from <mark>compilation</mark> entry<br />
                                If you have more than once <mark>compilation</mark> entry then remove the different one.
                            </div>
                            <strong>3.</strong> Publish the project into your IIS server with the options below:
                            <div class="note">
                                <strong>Note</strong><br/>
                                To publish the project on IIS you need to run Visual Studio as Administrator;
                            </div>
                        
                            <p>Connection:</p>
                            <div class="code">
                                <code>
                                    - Publish method: Web deploy<br/>
                                    - Server: localhost (no port number)<br/>
                                    - Site name: NugetServer (site name in IIS)<br/>
                                    - Destination URL: http://localhost:8080 (site address)
                                </code>
                            </div>
    
                            <p>Settings:</p>
                            <div class="code">
                                <code>
                                    - Configuration: Release<br/>
                                    - Expand <mark>File Publish Options</mark> and check <mark>Exclude file from the App_Data folder</mark>
                                </code>
                            </div>
                        </p>
                        
                        <h3>Nuget Package project</h3>
                        <p>
                            In Visual Studio create a new <mark>Class Library</mark> project and add a simple method that returns whatever value in order to test it later in the Sample project.<br/>
                            Download <em>Nuget.exe</em> from <a href="https://www.nuget.org/downloads" target="_blank">https://www.nuget.org/downloads</a> and run the next command where the <em>.csproj</em> is located in order to create the <mark>.nuspec</mark> file.</p>
                        <div class="code">
                            <code class="prompt">
                                nuget.exe spec
                            </code>
                        </div>
    
                        <div class="note">
                            <strong>Note</strong><br/>
                            If you have an error like <br/>
                            <code>Unexpected token 'spec' in expression or statement. + CategoryInfo : ParserError: (:) [], ParentContainsErrorRecordException + FullyQualifiedErrorId : UnexpectedToken</code><br/>
                            Try to copy the <em>nuget.exe</em> to the same folder that <em>.csproj</em> file and run it from there.
                        </div>
                        
                        <p>Open the <em>.nuspec</em> file created and complete all information.</p>
                        <p>Build the project in <mark>Release</mark> mode and generate the nuget package with:</p>
                        <div class="code">
                            <code class="prompt">
                                nuget.exe pack Project_name.csproj -Prop Configuration=Release
                            </code>
                        </div>
                        <div class="note">
                            <strong>Note</strong><br/>
                            The previous command could fail if you don't fill correctly the <em>.nuspec</em> file.
                        </div>
                        <p>Finally copy the <em>.nupkg</em> file created into the <mark>Packages</mark> folder of the NugetServer.</p>
    
                        <h3>Sample project</h3>
                        <p>
                            Create a new <mark>Console App</mark> project and configure the Nuget repository.
                            <div class="code">
                                <code>Tools -> Nuget Package Manager -> Package Manager Settings -> Package Sources</code>
                            </div>
                            
                            <p>Add a new one with this options:</p>
                            <div class="code">
                                <code>
                                        Name: Local Server<br/>
                                        Source: http://localhost:8080/nuget<br />
                                        Click on Update then Ok
                                </code>
                            </div>
                            <div class="note">
                                <strong>Note</strong><br/>
                                If there is an error getting the list of packages from local server like the image below
                                <img src="../images/create-local-nuget-server-1.PNG" title="Error ocurred getting the packages list from local Nuget server"><br/>
                                check the Output console to know more about the error.<br/>
                                <code>
                                    [Local Server] The V2 feed at 'http://localhost:8080/Search()?$filter=IsLatestVersion&searchTerm=''&targetFramework='net47'&includePrerelease=false&$skip=0&$top=26&semVerLevel=2.0.0' returned an unexpected status code '500 Internal Server Error'.
                                </code><br/>
                                In this case the error 500 means that the sever cannot server the packages and is related with the note in the <a href="#nuget-server-note1">Nuget Server project</a> section.
                            </div>
                            If all works correctly then you have access to your package and all its classes and methods.
                        </p>
                        
                        <h3>Extra: Automatise the package creation</h3>
                        <p>
                            This is an alternative version of the Nuget Package project. Instead of create the package and copy it to the server manually, these tasks are performed by a script when you build the project.
                            </p>
                            <p>
                            Start in the same way creating the <mark>Class Library</mark> project and create a folder <mark>Tools</mark> in the solution folder then copy the <em>nuget.exe</em> file into it.<br/>
                            Create a <mark>Post-Build event</mark> with the content below to create the nuget package automatically and be moved to the Packages folder of the Nuget server</p>
                            <div class="code">
                                <code>
                                    "$(SolutionDir)Tools\nuget.exe" pack "$(ProjectPath)" -Prop Configuration=Release<br/>
                                    <br/>
                                    if exist "$(TargetDir)*.nupkg" (<br/>
                                    &emsp;&emsp;move "$(TargetDir)*.nupkg" "D:\path_to_server\Packages"<br/>
                                    )
                                </code>
                            </div>         
                            Be sure that the version of the library has been incremented after the build. I use <a href="https://visualstudiogallery.msdn.microsoft.com/dd8c5682-58a4-4c13-a0b4-9eadaba919fe/">Automatic Versions</a>
                            Now if you build several times you can check in the Sample project the latest version available for download.
                            <div class="note">
                                <strong>Note</strong><br/>
                                If you don't see the new versions available that means the new nuget packages has not been generated.<br/>
                                You can check all versions available of the package in the <em>Packages/package_name</em> folder on Nuget Sever. If there is only one, means that something gone wrong.<br />
                                If you are reusing the Nuget Package Sample project be sure to remove the <em>.nuspec</em> and <em>.nupkg</em> files from project folder because you don't needed now also remove the <em>.nupkg</em> file from the Nuget Server that you copied manually.
                            </div>
                        </p>
    
                        <div class="post-references-section">
                            <h2>References</h2>
                            <a href="http://docs.nuget.org/create/hosting-your-own-nuget-feeds" target="_blank">Hosting Your Own NuGet Feeds</a><br/>
                            <a href="http://docs.nuget.org/create/Creating-and-Publishing-a-Package" target="_blank">Creating and Publishing a Package</a>
                        </div>
                    </div> <!-- post -->
                    <div class="footer mt-4">
                        <a class="comments" href="https://davamix.net/posts/create-local-nuget-server.html#post-comments">
                            <div id="blog-post-date3"></div>
                        </a>
                        <hr />
                        <script type="text/javascript">
                            GetTotalComments(3);
                        </script>
                    </div>


                    
        
                

            </div>
        </div> <!-- blog -->
    </main>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>
        <script defer src="https://pro.fontawesome.com/releases/v5.2.0/js/all.js" integrity="sha384-yBZ34R8uZDBb7pIwm+whKmsCiRDZXCW1vPPn/3Gz0xm4E95frfRNrOmAUfGbSGqN" crossorigin="anonymous"></script>
</body>

</html>